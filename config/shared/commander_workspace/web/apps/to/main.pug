extends ../../common/layout

block header
        i.fa-fw.fa.fa-signal
        | Telemetry Output

block main
  .row
    article.col-xs-12.col-sm-12.col-md-6.col-lg-4
        #wid-TO-CmdAndData.jarviswidget.jarviswidget-color-blueDark(data-widget-editbutton='false')
          header
            span.widget-icon
              i.fa.fa-table
            h2 General
          div
            .jarviswidget-editbox
              input.form-control(type='text')
            .widget-body
              .table-responsive
                table.table.table-condensed
                  tbody
                    tr
                      th Cmd Count
                      td 
                        span(data-sage={tlm: [{name:'/CFS/TO/CmdCounter'}]}) ---
                    tr
                      th Cmd Error Count
                      td
                        span(data-sage={tlm: [{name:'/CFS/TO/ErrCounter'}]}) ---
                    tr
                      th Total Messages Dropped
                      td
                        span(data-sage={tlm: [{name:'/CFS/TO/TotalMsgsDropped'}]}) ---
                    tr
                      th No Serialization Func Count
                      td
                        span(data-sage={tlm: [{name:'/CFS/TO/NoSerFuncCount'}]}) ---
              footer
                .btn-group.btn-group-sm.btn-space
                  button.btn.btn-primary(data-sage={cmd: {name:'/CFS/TO/NoOp'}}) No-Op
                  button.btn.btn-primary(data-sage={cmd: {name:'/CFS/TO/Reset'}}) Reset Counters
                  button.btn.btn-primary(data-sage={cmd: {name:'/CFS/TO/AddMessage'}}) Add Message
                  button.btn.btn-primary(data-sage={cmd: {name:'/CFS/TO/RemoveMessage'}}) Remove Message
                  button.btn.btn-primary(data-sage={cmd: {name:'/CFS/TO/QueryMessageFlow'}}) Query Message Flow
                  button.btn.btn-primary(data-sage={cmd: {name:'/CFS/TO/QueryPriorityQueue'}}) Query Priority Queue
                  button.btn.btn-primary(data-sage={cmd: {name:'/CFS/TO/QueryOutputChannel'}}) Query Output Channel
              
       
    article.col-xs-11.col-sm-6.col-md-5.col-lg-4(style='width:350px')
      #wid-TO-Memory.jarviswidget.jarviswidget-color-blueDark(data-widget-editbutton='false')
        header
          span.widget-icon
            i.fa.fa-table
          h2 Memory
            button.btn.btn-xs.btn-primary.btn-labeled.sage-cmd-inline(onclick='SendMemoryPoolStats()') Send
        div
          .jarviswidget-editbox
            input.form-control(type='text')
          .widget-body
            .table-responsive
              table.table.table-condensed
                tbody
                  tr  
                    th Pool Handle
                    td 
                      span#CFE_SB_MemPoolHandle(data-sage={tlm:[{name:'/CFS/TO/MemPoolHandle', format:'0x%08x'}]} onchange='UpdatePoolHandleColors();') ---                    
                  tr
                    th Pool handle
                    td 
                      span#CFE_ES_PoolStats_Handle(data-sage={tlm:[{name:'/CFS/CFE_ES/PoolStats_Handle', format:'0x%08x'}]} onchange='UpdatePoolHandleColors();') ---
                  tr
                    th Pool size
                    td 
                      span(data-sage={tlm:[{name:'/CFS/CFE_ES/PoolStats_Size'}]}) ---
                  tr
                    th Num blocks requested
                    td 
                      span(data-sage={tlm:[{name:'/CFS/CFE_ES/PoolStats_NumBlocksRequested'}]}) ---
                  tr
                    th Check error count
                    td 
                      span(data-sage={tlm:[{name:'/CFS/CFE_ES/PoolStats_CheckErrCtr'}]}) ---
                  tr
                    th Num free bytes
                    td
                      span(data-sage={tlm:[{name:'/CFS/CFE_ES/PoolStats_NumFreeBytes'}]}) ---           
            .table-responsive
              table.table.table-striped.table-condensed.table-memory
                thead
                  th(style='width:50px') #
                  th(style='width:100px') Block Size
                  th(style='width:75px') Created
                  th(style='width:75px') Free
                tbody
                  tr
                    th 0
                    td
                      span(data-sage={tlm:[{name:'/CFS/CFE_ES/PoolStats_Block0_Size'}]}) ---
                    td
                      span(data-sage={tlm:[{name:'/CFS/CFE_ES/PoolStats_Block0_NumCreated'}]}) ---
                    td
                      span(data-sage={tlm:[{name:'/CFS/CFE_ES/PoolStats_Block0_NumFree'}]}) ---
                  tr
                    th 1
                    td
                      span(data-sage={tlm:[{name:'/CFS/CFE_ES/PoolStats_Block1_Size'}]}) ---
                    td
                      span(data-sage={tlm:[{name:'/CFS/CFE_ES/PoolStats_Block1_NumCreated'}]}) ---
                    td
                      span(data-sage={tlm:[{name:'/CFS/CFE_ES/PoolStats_Block1_NumFree'}]}) ---
                  tr
                    th 2
                    td
                      span(data-sage={tlm:[{name:'/CFS/CFE_ES/PoolStats_Block2_Size'}]}) ---
                    td
                      span(data-sage={tlm:[{name:'/CFS/CFE_ES/PoolStats_Block2_NumCreated'}]}) ---
                    td
                      span(data-sage={tlm:[{name:'/CFS/CFE_ES/PoolStats_Block2_NumFree'}]}) ---
                  tr
                    th 3
                    td
                      span(data-sage={tlm:[{name:'/CFS/CFE_ES/PoolStats_Block3_Size'}]}) ---
                    td
                      span(data-sage={tlm:[{name:'/CFS/CFE_ES/PoolStats_Block3_NumCreated'}]}) ---
                    td
                      span(data-sage={tlm:[{name:'/CFS/CFE_ES/PoolStats_Block3_NumFree'}]}) ---
                  tr
                    th 4
                    td
                      span(data-sage={tlm:[{name:'/CFS/CFE_ES/PoolStats_Block4_Size'}]}) ---
                    td
                      span(data-sage={tlm:[{name:'/CFS/CFE_ES/PoolStats_Block4_NumCreated'}]}) ---
                    td
                      span(data-sage={tlm:[{name:'/CFS/CFE_ES/PoolStats_Block4_NumFree'}]}) ---
                  tr
                    th 5
                    td
                      span(data-sage={tlm:[{name:'/CFS/CFE_ES/PoolStats_Block5_Size'}]}) ---
                    td
                      span(data-sage={tlm:[{name:'/CFS/CFE_ES/PoolStats_Block5_NumCreated'}]}) ---
                    td
                      span(data-sage={tlm:[{name:'/CFS/CFE_ES/PoolStats_Block5_NumFree'}]}) ---
                  tr
                    th 6
                    td
                      span(data-sage={tlm:[{name:'/CFS/CFE_ES/PoolStats_Block6_Size'}]}) ---
                    td
                      span(data-sage={tlm:[{name:'/CFS/CFE_ES/PoolStats_Block6_NumCreated'}]}) ---
                    td
                      span(data-sage={tlm:[{name:'/CFS/CFE_ES/PoolStats_Block6_NumFree'}]}) ---
                  tr
                    th 7
                    td
                      span(data-sage={tlm:[{name:'/CFS/CFE_ES/PoolStats_Block7_Size'}]}) ---
                    td
                      span(data-sage={tlm:[{name:'/CFS/CFE_ES/PoolStats_Block7_NumCreated'}]}) ---
                    td
                      span(data-sage={tlm:[{name:'/CFS/CFE_ES/PoolStats_Block7_NumFree'}]}) ---
                  tr
                    th 8
                    td
                      span(data-sage={tlm:[{name:'/CFS/CFE_ES/PoolStats_Block8_Size'}]}) ---
                    td
                      span(data-sage={tlm:[{name:'/CFS/CFE_ES/PoolStats_Block8_NumCreated'}]}) ---
                    td
                      span(data-sage={tlm:[{name:'/CFS/CFE_ES/PoolStats_Block8_NumFree'}]}) ---
                  tr
                    th 9
                    td
                      span(data-sage={tlm:[{name:'/CFS/CFE_ES/PoolStats_Block9_Size'}]}) ---
                    td
                      span(data-sage={tlm:[{name:'/CFS/CFE_ES/PoolStats_Block9_NumCreated'}]}) ---
                    td
                      span(data-sage={tlm:[{name:'/CFS/CFE_ES/PoolStats_Block9_NumFree'}]}) ---
                  tr
                    th 10
                    td
                      span(data-sage={tlm:[{name:'/CFS/CFE_ES/PoolStats_Block10_Size'}]}) ---
                    td
                      span(data-sage={tlm:[{name:'/CFS/CFE_ES/PoolStats_Block10_NumCreated'}]}) ---
                    td
                      span(data-sage={tlm:[{name:'/CFS/CFE_ES/PoolStats_Block10_NumFree'}]}) ---
                  tr
                    th 11
                    td
                      span(data-sage={tlm:[{name:'/CFS/CFE_ES/PoolStats_Block11_Size'}]}) ---
                    td
                      span(data-sage={tlm:[{name:'/CFS/CFE_ES/PoolStats_Block11_NumCreated'}]}) ---
                    td
                      span(data-sage={tlm:[{name:'/CFS/CFE_ES/PoolStats_Block11_NumFree'}]}) ---
                  tr
                    th 12
                    td
                      span(data-sage={tlm:[{name:'/CFS/CFE_ES/PoolStats_Block12_Size'}]}) ---
                    td
                      span(data-sage={tlm:[{name:'/CFS/CFE_ES/PoolStats_Block12_NumCreated'}]}) ---
                    td
                      span(data-sage={tlm:[{name:'/CFS/CFE_ES/PoolStats_Block12_NumFree'}]}) ---
                  tr
                    th 13
                    td
                      span(data-sage={tlm:[{name:'/CFS/CFE_ES/PoolStats_Block13_Size'}]}) ---
                    td
                      span(data-sage={tlm:[{name:'/CFS/CFE_ES/PoolStats_Block13_NumCreated'}]}) ---
                    td
                      span(data-sage={tlm:[{name:'/CFS/CFE_ES/PoolStats_Block13_NumFree'}]}) ---
                  tr
                    th 14
                    td
                      span(data-sage={tlm:[{name:'/CFS/CFE_ES/PoolStats_Block14_Size'}]}) ---
                    td
                      span(data-sage={tlm:[{name:'/CFS/CFE_ES/PoolStats_Block14_NumCreated'}]}) ---
                    td
                      span(data-sage={tlm:[{name:'/CFS/CFE_ES/PoolStats_Block14_NumFree'}]}) ---
                  tr
                    th 15
                    td
                      span(data-sage={tlm:[{name:'/CFS/CFE_ES/PoolStats_Block15_Size'}]}) ---
                    td
                      span(data-sage={tlm:[{name:'/CFS/CFE_ES/PoolStats_Block15_NumCreated'}]}) ---
                    td
                      span(data-sage={tlm:[{name:'/CFS/CFE_ES/PoolStats_Block15_NumFree'}]}) ---
                  tr
                    th 16
                    td
                      span(data-sage={tlm:[{name:'/CFS/CFE_ES/PoolStats_Block16_Size'}]}) ---
                    td
                      span(data-sage={tlm:[{name:'/CFS/CFE_ES/PoolStats_Block16_NumCreated'}]}) ---
                    td
                      span(data-sage={tlm:[{name:'/CFS/CFE_ES/PoolStats_Block16_NumFree'}]}) ---



block scripts
  script.
      
      Handlebars.registerHelper('toHex16', function(context) {
        return sprintf("0x%04x", context);
      }); 
      
      function UpdatePoolHandleColors() {
        if($('#/CFS/TO/MemPoolHandle').text() === $('#CFE_ES_PoolStats_Handle').text())
        {
            $('#/CFS/TO/MemPoolHandle').css({'color':'green'});
            $('#CFE_ES_PoolStats_Handle').css({'color':'green'}); 
        }
        else
        {
            $('#/CFS/TO/MemPoolHandle').css({'color':'red'});
            $('#CFE_ES_PoolStats_Handle').css({'color':'red'}); 
        }
      }
